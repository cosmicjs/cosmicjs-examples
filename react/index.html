<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Cosmic JS Example App - React</title>
</head>
<body>
	<div id="app-root"></div>
	<script src="react.min.js"></script>
	<script src="browser.min.js"></script>
	<script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
	<script type="text/babel">
		class AppRoot extends React.Component {

			constructor(){

				super();

				this.state = {
					data: {}
				}

			}

			componentDidMount(){

				let _this = this;

				let url = 'https://api.cosmicjs.com/v1/wedding-site';
				
				$.getJSON(url, function( data ) {
					
					let objects = data.bucket.objects;
					let media = data.bucket.media;
					
	        this.setState({
						data: {
							objects: objects,
							media: media
						}
					});

				}.bind(this));
			}

			render(){
				
				let objects = this.state.data.objects;
				let media = this.state.data.media;
				let objects_list = '';

				if(objects){
					objects_list = objects.map(function(object){
						return (
							<div>
								<CosmicObj object={ object } />
							</div>
						);
					});
				}

				return (
					<div>
						<h1>Objects</h1>
						{ objects_list }
						<h4>Media</h4>
						<MediaList media={ media }/>
					</div>
				);

			}
		}

		class CosmicObj extends React.Component {

			render(){

				return (
					<div>
						{ this.props.object.title }
					</div>
				);
			}
		}

		class MediaList extends React.Component {

			render(){

				let media_list = '';
				let media = this.props.media;
				if(media){
					media_list = media.map(function(media_object){
						return (
							<div>
								<img src={ media_object.location + '/' + media_object.name } />
							</div>
						);
					});
				}

				return (
					<div>
						{ media_list }
					</div>
				);
			}
		}

		React.render(
	  <AppRoot />,
		  document.getElementById('app-root')
		);
	</script>
</body>
</html>